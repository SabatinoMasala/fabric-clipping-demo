webpackJsonp([1],{"05jh":function(t,e,i){"use strict";var n=i("woOf"),a=i.n(n),o=i("7t+N"),s=i.n(o);e.a={handleEvent:function(t,e){if(0!==t.target.files.length){var i=t.target.files[0],n=new FileReader;n.onload=function(t){var i=t.target.result;fabric.Image.fromURL(i,function(t){var i=0,n=null,o={left:0,top:0,originX:"left",originY:"top",angle:0},s={};t.width>t.height?(i=t.width/t.height,s=a()(o,{width:1,height:1/i})):(i=t.height/t.width,s=a()(o,{width:1/i,height:1})),n=t.set(s),e(n)})},n.readAsDataURL(i),s()(t.currentTarget).val("")}}}},"7iRb":function(t,e){},M93x:function(t,e,i){"use strict";function n(t){i("7iRb")}var a=i("xJD8"),o=i("lyur"),s=i("VU/8"),c=n,l=s(a.a,o.a,!1,c,null,null);e.a=l.exports},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/5sW"),a=i("M93x");n.a.config.productionTip=!1,new n.a({el:"#app",render:function(t){return t(a.a)}})},f384:function(t,e){var i=void 0,n=void 0;fabric.Canvas.prototype.panState="idle",fabric.Canvas.prototype.panMouseMoveHandler=function(t){if("panning"===this.panState&&t&&t.e){var e=0,a=0;i&&(e=t.e.clientX-i),n&&(a=t.e.clientY-n),i=t.e.clientX,n=t.e.clientY;var o=new fabric.Point(e,a);this.relativePan(o),this.trigger("moved")}},fabric.Canvas.prototype.panMouseUpHandler=function(t){this.panState="idle"},fabric.Canvas.prototype.panMouseDownHandler=function(t){this.panState="panning",i=t.e.clientX,n=t.e.clientY},fabric.Canvas.prototype.toggleDragMode=function(t){t?(this.discardActiveObject(),this.defaultCursor="move",this.forEachObject(function(t){t.prevEvented=t.evented,t.prevSelectable=t.selectable,t.evented=!1,t.selectable=!1}),this.selection=!1,this.on("mouse:up",this.panMouseUpHandler),this.on("mouse:down",this.panMouseDownHandler),this.on("mouse:move",this.panMouseMoveHandler)):(this.forEachObject(function(t){t.evented=void 0!==t.prevEvented?t.prevEvented:t.evented,t.selectable=void 0!==t.prevSelectable?t.prevSelectable:t.selectable}),this.defaultCursor="default",this.off("mouse:up",this.panMouseUpHandler),this.off("mouse:down",this.panMouseDownHandler),this.off("mouse:move",this.panMouseMoveHandler),this.selection=!0)}},gSRr:function(t,e){},lyur:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("github-corners",{attrs:{repo:"SabatinoMasala/fabric-clipping-demo"}}),t._v(" "),i("div",{staticClass:"text-center",attrs:{id:"toolbar"}},[i("button",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.zoomIn(e)}}},[t._v("Zoom in")]),t._v(" "),i("button",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.zoomOut(e)}}},[t._v("Zoom out")]),t._v(" "),i("div",{staticClass:"spacer"},[t._v(" ")]),t._v(" "),t.dragMode?i("button",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.dragMode=!1}}},[t._v("Stop panning")]):i("button",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.dragMode=!0}}},[t._v("Start panning")]),t._v(" "),i("div",{staticClass:"spacer"},[t._v(" ")]),t._v(" "),i("button",{on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.reset()}}},[t._v("Reset pan & zoom")]),t._v(" "),t.activeObject?i("div",{staticClass:"spacer"},[t._v(" ")]):t._e(),t._v(" "),t.activeObject?i("button",{staticClass:"delete",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.removeActiveObject()}}},[t._v("Delete object")]):t._e()]),t._v(" "),i("h1",{staticClass:"text-center heading"},[t._v("Fabric.js clipping & panning demo")]),t._v(" "),i("div",{attrs:{id:"app"}},[i("div",{staticClass:"wrapper"},[i("canvas",{attrs:{id:"canvas",width:"500",height:"500"}}),t._v(" "),i("div",{staticClass:"text-center"},[t.helpMessage?i("p",{staticClass:"help"},[t._v(t._s(t.helpMessage))]):t._e()])])])],1)},a=[],o={render:n,staticRenderFns:a};e.a=o},wuSQ:function(t,e,i){"use strict";var n=i("woOf"),a=i.n(n),o=i("Zrlr"),s=i.n(o),c=i("wxAW"),l=i.n(c),r=i("7t+N"),h=i.n(r),d=i("05jh"),v=i("M4fF"),p=i.n(v),u=function(){function t(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s()(this,t);var o={originX:"left",originY:"top",fill:"#FF8552",strokeWidth:0,selectable:!1,evented:!1},c=a()({},o,n);this.state={hasImage:!1,hover:!1,selected:!1},this.canvas=e,this.clipRect=new fabric.Rect(c),this.clipRect.on("moving",function(t){i._positionButtons()}),this.canvas.on("moved",function(t){i._positionButtons()}),this.canvas.on("mouse:move",p.a.throttle(function(t){if(!i.state.selected){var e=t.e,n=i.canvas.viewportTransform[4],a=i.canvas.viewportTransform[5],o=!1,s=e.offsetX,c=e.offsetY;s>i._zoom(i.clipRect.left+n,!1)&&s<i._zoom(i.clipRect.left+i.clipRect.width+n,!1)&&c>i._zoom(i.clipRect.top+a,!1)&&c<i._zoom(i.clipRect.top+i.clipRect.height+a,!1)&&(o=!0),i._setState({hover:o})}},1)),this.inputUpload=document.createElement("input"),this.inputUpload.type="file",document.body.append(this.inputUpload),this.btnUpload=document.createElement("button"),this.btnUpload.innerHTML="Upload",this.btnUpload.style.position="absolute",h()(".canvas-container").append(this.btnUpload),this.btnSelect=document.createElement("button"),this.btnSelect.innerHTML="Select",this.btnSelect.className="cliprect_toolbar__edit",this.btnSelect.style.position="absolute",h()(this.btnSelect).hide(),h()(".canvas-container").append(this.btnSelect),this.btnDelete=document.createElement("button"),this.btnDelete.innerHTML="Delete",this.btnDelete.className="cliprect_toolbar__delete",this.btnDelete.style.position="absolute",h()(this.btnDelete).hide(),h()(".canvas-container").append(this.btnDelete),h()(this.btnUpload).click(this._onClickButtonUpload.bind(this)),h()(this.btnDelete).click(this._handleDelete.bind(this)),h()(this.btnSelect).click(this._handleEdit.bind(this)),h()(this.inputUpload).change(this._handleUpload.bind(this))}return l()(t,[{key:"_handleEdit",value:function(t){this.canvas.setActiveObject(this.fabricImage)}},{key:"_handleDelete",value:function(t){this.fabricImage.remove()}},{key:"_handleUpload",value:function(t){var e=this;d.a.handleEvent(t,function(t){e._loadImage(t)})}},{key:"_loadImage",value:function(t){var e=this,i=this;t.set({left:this.clipRect.left,top:this.clipRect.top,width:t.width*this.clipRect.width,height:t.height*this.clipRect.width,clipTo:function(t){var e=this.canvas.viewportTransform[4],n=this.canvas.viewportTransform[5];this.setCoords(),t.save(),t.setTransform(1,0,0,1,0,0),t.beginPath(),t.rect(i._zoom(i.clipRect.left)+i._multiplied(e),i._zoom(i.clipRect.top)+i._multiplied(n),i._zoom(i.clipRect.width),i._zoom(i.clipRect.height)),t.closePath(),t.restore()}}),this.fabricImage=t,t.on("removed",function(t){e._setState({hasImage:!1})}),t.on("deselected",function(i){t.set({}),e._setState({selected:!1})}),t.on("selected",function(i){t.set({evented:!0,selectable:!0}),e._setState({selected:!0})}),this.canvas.add(t).renderAll(),this.canvas.setActiveObject(t),this._setState({hasImage:!0})}},{key:"_degToRad",value:function(t){return t*(Math.PI/180)}},{key:"_setState",value:function(t){t=a()({},this.state,t),t.hasImage!==this.state.hasImage&&(t.hasImage?(h()(this.btnUpload).hide(),h()(this.btnDelete).show()):(h()(this.btnUpload).show(),h()(this.btnDelete).hide(),h()(this.btnSelect).hide()),this._positionButtons()),t.hasImage&&t.selected!==this.state.selected&&(t.selected?h()(this.btnSelect).hide():h()(this.btnSelect).show(),this._positionButtons()),t.hover!==this.state.hover&&(t.hover?this.fabricImage&&this.fabricImage.set({evented:!0,selectable:!0}):this.fabricImage&&this.fabricImage.set({evented:!1,selectable:!1}),this.canvas.renderAll()),this.state=t}},{key:"_onClickButtonUpload",value:function(t){h()(this.inputUpload).trigger("click")}},{key:"_getDomCanvasPosition",value:function(){return h()(this.canvas.upperCanvasEl).offset()}},{key:"_multiplied",value:function(t){return fabric.window.devicePixelRatio*t}},{key:"_zoom",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t*(this.canvas.getZoom()*(e?fabric.window.devicePixelRatio:1))}},{key:"_positionButtons",value:function(){var t=this._getDomCanvasPosition(),e=this.canvas.viewportTransform[4],i=this.canvas.viewportTransform[5],n={top:this._zoom(this.clipRect.top,!1),left:this._zoom(this.clipRect.left,!1),width:this._zoom(this.clipRect.width,!1),height:this._zoom(this.clipRect.height,!1)},a={width:h()(this.btnUpload).outerWidth(),height:h()(this.btnUpload).outerHeight()};h()(this.btnUpload).offset({top:n.top+n.height/2+i-a.height/2+t.top,left:n.left+n.width/2+e-a.width/2+t.left}),h()(this.btnDelete).offset({top:n.top+i+t.top+7,left:n.left+e+t.left+7}),h()(this.btnSelect).offset({top:n.top+i+t.top+50,left:n.left+e+t.left+7})}},{key:"render",value:function(){this.canvas.add(this.clipRect).renderAll(),this._positionButtons()}}]),t}();e.a=u},xJD8:function(t,e,i){"use strict";var n=i("/5sW"),a=i("7RXh"),o=i.n(a),s=i("gSRr"),c=(i.n(s),i("7t+N")),l=i.n(c),r=i("wuSQ"),h=i("f384");i.n(h);n.a.use(o.a),e.a={name:"fabric-clipping-demo",computed:{helpMessage:function(){return this.activeObject?"Press backspace to delete the object":!!this.dragMode&&"Drag the canvas to pan"}},methods:{removeActiveObject:function(){this.activeObject.remove(),this.canvas.renderAll()},reset:function(){this.canvas.setZoom(1),this.canvas.absolutePan(new fabric.Point(0,0)),this.dragMode=!1,this.canvas.trigger("moved")},zoomIn:function(){this.canvas.setZoom(this.canvas.getZoom()+.2),this.canvas.trigger("moved")},zoomOut:function(){this.canvas.setZoom(this.canvas.getZoom()-.2),this.canvas.trigger("moved")}},watch:{dragMode:function(){this.canvas.toggleDragMode(this.dragMode)}},mounted:function(){var t=this;this.canvas=new fabric.Canvas("canvas"),this.canvas.backgroundColor="#fff",this.canvas.on("object:selected",function(e){t.activeObject=e.target}),this.canvas.on("selection:cleared",function(e){t.activeObject=!1});for(var e=0;e<3;e++)for(var i=0;i<3;i++){var n=new r.a(this.canvas,{left:251*i,top:251*e,width:249,height:249});n.render()}l()("body").keydown(function(e){if(8===e.keyCode){var i=t.canvas.getActiveObject();i&&(i.remove(),t.canvas.renderAll())}})},data:function(){return{canvasVisible:!0,activeObject:!1,canvas:!1,dragMode:!1}}}}},["NHnr"]);
//# sourceMappingURL=app.377f34714998a63a6e7f.js.map